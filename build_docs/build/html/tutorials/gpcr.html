

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GPCR tutorial &mdash; pele platform 1.5.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fragment growing tutorial" href="frag_pele.html" />
    <link rel="prev" title="Docking pose refinement tutorial" href="induced_fit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pele platform
          

          
          </a>

          
            
            
              <div class="version">
                1.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../packages/index.html">Prepare your own simulation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Optative flags</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ppi.html">Protein-protein interaction tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="induced_fit.html">Docking pose refinement tutorial</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GPCR tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#protein-preparation">1. Protein preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ligand-preparation">2. Ligand preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pele-input-file">3. PELE input file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-the-simulation">4. Launching the simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-of-the-results">5. Analysis of the results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-plots">a. Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="#b-best-structures">b. Best structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-clusters">c. Clusters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="frag_pele.html">Fragment growing tutorial</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">Analysis</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../errors/index.html">Common errors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Versions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pele platform</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>GPCR tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/gpcr.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gpcr-tutorial">
<h1>GPCR tutorial<a class="headerlink" href="#gpcr-tutorial" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will run a GPCR cross-simulation which aims to find the path of BU72 agonist (PDB code 5C1M)
to the orthosteric site of μ-opioid receptor (PDB code 6DDE).</p>
<p>Initially, the software will randomise the position of the ligand around the specified initial site, then perform a simulation
slightly biased against the solvent accessible surface area. The setup will automatically constrain α-carbons to prevent the collapse of
the initial structure due to the lack of membrane as well as set up a simulation box encompassing both the initial and the orthosteric site.</p>
<div class="section" id="protein-preparation">
<h2>1. Protein preparation<a class="headerlink" href="#protein-preparation" title="Permalink to this headline">¶</a></h2>
<p>We will import the complex from Protein Data Bank and preprocess it using Schrödinger Maestro (release 2020-1).</p>
<p>a. Launch Maestro and <strong>import the structure from PDB</strong> by clicking <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Get</span> <span class="pre">PDB...</span></code>, type in your PDB ID, e.g. <code class="docutils literal notranslate"><span class="pre">6DDE</span></code>,
and click <code class="docutils literal notranslate"><span class="pre">Download</span></code>. The protein structure should appear in your workspace.</p>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_1a.png"><img alt="../_images/gpcr_tutorial_1a.png" class="align-center" src="../_images/gpcr_tutorial_1a.png" style="width: 400px;" /></a>
<p>b. Remove redundant chains from the structure. Click on <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">-&gt;</span> <span class="pre">Set</span> <span class="pre">pick</span> <span class="pre">level</span> <span class="pre">-&gt;</span> <span class="pre">Chains</span></code>, then in the workspace select all chains except for R. Open <code class="docutils literal notranslate"><span class="pre">Build</span></code> window and remove
selected atoms.</p>
<p>c. <strong>Preprocess the protein</strong> using Protein Preparation Wizard. Click on <code class="docutils literal notranslate"><span class="pre">Tasks</span></code> and search <code class="docutils literal notranslate"><span class="pre">Protein</span> <span class="pre">Preparation</span> <span class="pre">Wizard</span></code>.
Check the following options and hit <code class="docutils literal notranslate"><span class="pre">Preprocess</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li><p>Fill in missing side chain using Prime*</p></li>
<li><p>Fill in missing loops using Prime*</p></li>
<li><p>Delete waters beyond 0.0 Å from het groups (i.e. all waters in the system)</p></li>
</ul>
</div></blockquote>
<p>*If you do not have Prime license, you can skip those steps.</p>
<a class="reference internal image-reference" href="../_images/allosteric_tutorial_1b.png"><img alt="../_images/allosteric_tutorial_1b.png" class="align-center" src="../_images/allosteric_tutorial_1b.png" style="width: 400px;" /></a>
<p>The preprocessing might take a few minutes… Afterwards, Maestro will warn you about overlapping hydrogen atoms - to resolve it, simply go to <code class="docutils literal notranslate"><span class="pre">Refine</span></code>
tab of the Protein Preparation Wizard and perform restrained minimization on hydrogens only.</p>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_1c.png"><img alt="../_images/gpcr_tutorial_1c.png" class="align-center" src="../_images/gpcr_tutorial_1c.png" style="width: 400px;" /></a>
<p>In the end you should see <code class="docutils literal notranslate"><span class="pre">6DDE</span> <span class="pre">-</span> <span class="pre">minimized</span></code> entry in the table on your left.</p>
</div>
<div class="section" id="ligand-preparation">
<h2>2. Ligand preparation<a class="headerlink" href="#ligand-preparation" title="Permalink to this headline">¶</a></h2>
<p>a. Import structure <code class="docutils literal notranslate"><span class="pre">5C1M</span></code> from PDB and preprocess with Protein Preparation Wizard like before. Maestro will prompt you about
some double occupancy issues, you can resolve them by selecting all entries and clicking <code class="docutils literal notranslate"><span class="pre">Commit</span></code>.</p>
<ol class="loweralpha simple" start="2">
<li><dl class="simple">
<dt><strong>Extract the ligand</strong> and change its chain ID and residue name</dt><dd><ul class="simple">
<li><p>Click on <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">-&gt;</span> <span class="pre">Set</span> <span class="pre">pick</span> <span class="pre">level</span> <span class="pre">-&gt;</span> <span class="pre">Residues</span></code>, then select ligand <code class="docutils literal notranslate"><span class="pre">4VO</span></code> (residue 401) with a mouse click</p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">Build</span></code> and choose <code class="docutils literal notranslate"><span class="pre">Other</span> <span class="pre">edits</span> <span class="pre">-&gt;</span> <span class="pre">Change</span> <span class="pre">atom</span> <span class="pre">properties...</span></code></p></li>
<li><p>Set residue name to <code class="docutils literal notranslate"><span class="pre">LIG</span></code> and chain name to <code class="docutils literal notranslate"><span class="pre">Z</span></code></p></li>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">PDB</span> <span class="pre">atom</span> <span class="pre">name</span></code> from the drop down list and select <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">unique</span> <span class="pre">PDB</span> <span class="pre">atom</span> <span class="pre">names</span> <span class="pre">within</span> <span class="pre">residues</span></code></p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Apply</span></code> and close the window</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">Build</span></code> window click the button highlighted below to extract the ligand to a separate entry.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_2b.png"><img alt="../_images/gpcr_tutorial_2b.png" class="align-center" src="../_images/gpcr_tutorial_2b.png" style="width: 300px;" /></a>
<ol class="loweralpha simple" start="3">
<li><dl class="simple">
<dt><strong>Merge</strong> the protein and the ligand entries:</dt><dd><ul class="simple">
<li><p>Select both enties by holding Ctrl button</p></li>
<li><p>Right click and choose <code class="docutils literal notranslate"><span class="pre">Merge</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<p>This will create a new entry containing both preprocessed 5C1M ligand and 6DDE receptor structure. The initial position of the ligand does not matter since PELE automatically
moves it to the simulation box created based on the specified initial and orthosteric sites.</p>
<p>d. <strong>Pick atom</strong> to track progress. One of the metrics we use to follow the simulation is the distance between two
selected atoms. In this case, we will pick ligand atom <code class="docutils literal notranslate"><span class="pre">Z:401:C13</span></code> and then track its distance to the orthosteric site.</p>
<p>e. <strong>Export merged structure</strong> by clicking on <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Export</span> <span class="pre">structures...</span></code> and save all workspace atoms as <code class="docutils literal notranslate"><span class="pre">complex.pdb</span></code>
in your working directory. You can close Maestro now.</p>
</div>
<div class="section" id="pele-input-file">
<h2>3. PELE input file<a class="headerlink" href="#pele-input-file" title="Permalink to this headline">¶</a></h2>
<p>Create <code class="docutils literal notranslate"><span class="pre">input.yaml</span></code> file in your working directory, it should contain the following flags:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>system</strong> - path to the protein-ligand PDB file</p></li>
<li><p><strong>chain</strong> - ligand chain ID, here <code class="docutils literal notranslate"><span class="pre">Z</span></code></p></li>
<li><p><strong>resname</strong> - ligand residue name, in our case <code class="docutils literal notranslate"><span class="pre">LIG</span></code></p></li>
<li><p><strong>gpcr_orth</strong> - sets the defaults for the GPCR simulation</p></li>
<li><p><strong>orthosteric_site</strong> - atom in the orthosteric site</p></li>
<li><p><strong>initial_site</strong> - atom in the initial site</p></li>
<li><p><strong>atom_dist</strong> - atoms used to track the progress of the simulation, we will use one from the ligand and one from the receptor, following <code class="docutils literal notranslate"><span class="pre">chain</span> <span class="pre">ID:residue</span> <span class="pre">number:atom</span> <span class="pre">name</span></code> format</p></li>
<li><p><strong>cpus</strong> - number of CPUs you want to use for the simulation (we suggest a minimum of 50 for a normal simulation, but you could lower it for training purposes only)</p></li>
<li><p><strong>seed</strong> - random seed to ensure reproducibility.</p></li>
</ul>
</div></blockquote>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">system</span><span class="p">:</span> <span class="s">&#39;complex.pdb&#39;</span>
<span class="nt">chain</span><span class="p">:</span> <span class="s">&#39;Z&#39;</span>
<span class="nt">resname</span><span class="p">:</span> <span class="s">&#39;LIG&#39;</span>
<span class="nt">gpcr_orth</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">initial_site</span><span class="p">:</span> <span class="s">&quot;R:212:OE1&quot;</span> <span class="c1"># Gln212 oxygen</span>
<span class="nt">orthosteric_site</span><span class="p">:</span> <span class="s">&quot;R:124:NE2&quot;</span> <span class="c1"># Gln124 interacting with the 6DDE ligand</span>
<span class="nt">seed</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">12345</span>
<span class="nt">cpus</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="nt">atom_dist</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="s">&quot;R:124:NE2&quot;</span>
<span class="p p-Indicator">-</span> <span class="s">&quot;Z:401:C13&quot;</span>
</pre></div>
</div>
<p><strong>We strongly recommend running a test first to ensure all your input files are valid.</strong> Simply include <code class="docutils literal notranslate"><span class="pre">test:</span> <span class="pre">true</span></code> in your input.yaml and launch the simulation, it will only use 5 CPUs. If it finishes correctly, you can remove the test flag and start a full production run.
Otherwise, inspect the logs and correct any mistakes indicated in the error codes.</p>
</div>
<div class="section" id="launching-the-simulation">
<h2>4. Launching the simulation<a class="headerlink" href="#launching-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Once you have <code class="docutils literal notranslate"><span class="pre">complex.pdb</span></code> and <code class="docutils literal notranslate"><span class="pre">input.yaml</span></code> in your working directory, you can launch the simulation using one of the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>directly</strong> on command line using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pele_platform.main</span> <span class="pre">input.yaml</span></code></p></li>
<li><p>submit a slurm file to the <strong>queue system</strong> (ask your IT manager, if you are not sure how to do it). In our case, the slurm file is called <code class="docutils literal notranslate"><span class="pre">run.sl</span></code> and we can launch it on the command line using <code class="docutils literal notranslate"><span class="pre">sbatch</span> <span class="pre">slurm.sl</span></code></p></li>
</ul>
</div></blockquote>
<p>Example slurm file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>!/bin/bash
<span class="gp">#</span>SBATCH -J PELE
<span class="gp">#</span>SBATCH --output<span class="o">=</span>mpi_%j.out
<span class="gp">#</span>SBATCH --error<span class="o">=</span>mpi_%j.err
<span class="gp">#</span>SBATCH --ntasks<span class="o">=</span><span class="m">50</span>
<span class="gp">#</span>SBATCH --mem-per-cpu<span class="o">=</span><span class="m">1000</span>

<span class="go">python -m pele_platform.main input.yaml</span>
</pre></div>
</div>
<p>You can download ready slurm files for <code class="xref download docutils literal notranslate"><span class="pre">MareNostrum</span></code> and the <code class="xref download docutils literal notranslate"><span class="pre">NBD</span> <span class="pre">cluster</span></code>.
If you are running the simulation on the NBD cluster, you have to include <code class="docutils literal notranslate"><span class="pre">usesrun:</span> <span class="pre">true</span></code> in your input.yaml!</p>
</div>
<div class="section" id="analysis-of-the-results">
<h2>5. Analysis of the results<a class="headerlink" href="#analysis-of-the-results" title="Permalink to this headline">¶</a></h2>
<p>To ensure the simulation has finished, check the standard output file (in our case <code class="docutils literal notranslate"><span class="pre">mpi_xxxxx.out</span></code>, as indicated in the slurm file). It should contain the
following line at the end:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Pdf summary report successfully writen to: /your_working_directory/LIG_Pele/summary_results.pdf`</span>
</pre></div>
</div>
<p>All relevant simulation results, including best energy poses, clusters and plots are located in <code class="docutils literal notranslate"><span class="pre">LIG_Pele/results</span></code> directory. We will now explore
the content of each folder.</p>
<p>If you want to understand more about the content of <code class="docutils literal notranslate"><span class="pre">LIG_Pele</span></code> directory, you can refer to the PELE++ documentation:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://nostrumbiodiscovery.github.io/pele_docs/molecularParameters.html">Data folder</a></p></li>
<li><p><a class="reference external" href="https://nostrumbiodiscovery.github.io/pele_docs/GeneralStructure/GeneralStructure.html">pele.conf</a></p></li>
<li><p><a class="reference external" href="https://adaptivepele.github.io/AdaptivePELE/Examples.html#control-file-outline">adaptive.conf</a></p></li>
</ul>
</div></blockquote>
<div class="section" id="a-plots">
<h3>a. Plots<a class="headerlink" href="#a-plots" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Plots</span></code> directory contains several plots to help you get the general idea of the progress of the simulation, showing relationships between
the binding energy and solvent accessible surface area of the ligand, distance between two selected atoms or any other metric of your choice.</p>
<p>For example, the following plot clearly shows how binding energy improves as the distance between the ligand and the orthosteric site decreases.</p>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_5a.png"><img alt="../_images/gpcr_tutorial_5a.png" class="align-center" src="../_images/gpcr_tutorial_5a.png" style="width: 400px;" /></a>
</div>
<div class="section" id="b-best-structures">
<h3>b. Best structures<a class="headerlink" href="#b-best-structures" title="Permalink to this headline">¶</a></h3>
<p>PELE scans all produced poses and retrieves the top 100 lowest binding energy structures to the <code class="docutils literal notranslate"><span class="pre">BestStructs</span></code> folder. The file names indicate
the trajectory and model IDs of each structure as well as its associated binding energy.</p>
<p>Shown below is an example of a pose with binding energy of -91.1362 (green) superposed with
the original native structure (pink). The RMSD between the two ligands was 1.88 Å and most pharmacophore features were correctly reproduced.</p>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_5b.png"><img alt="../_images/gpcr_tutorial_5b.png" class="align-center" src="../_images/gpcr_tutorial_5b.png" style="width: 400px;" /></a>
</div>
<div class="section" id="c-clusters">
<h3>c. Clusters<a class="headerlink" href="#c-clusters" title="Permalink to this headline">¶</a></h3>
<p>To ensure no binding modes were omitted in the previous step, we also cluster all poses based on ligand heavy atom coordinates and retrieve the lowest
binding energy representative of each cluster. In this case, four cluster representatives show a similar binding mode to the one discussed above.</p>
<a class="reference internal image-reference" href="../_images/gpcr_tutorial_5c.png"><img alt="../_images/gpcr_tutorial_5c.png" class="align-center" src="../_images/gpcr_tutorial_5c.png" style="width: 400px;" /></a>
<p>For more information regarding the outputs of the tutorial see <a class="reference external" href="outputs.html">Output files</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="frag_pele.html" class="btn btn-neutral float-right" title="Fragment growing tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="induced_fit.html" class="btn btn-neutral float-left" title="Docking pose refinement tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, NBD | Nostrum Biodiscovery

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>